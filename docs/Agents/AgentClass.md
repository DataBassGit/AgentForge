# `Agent` Class Documentation

Welcome to the documentation of the `Agent` class. This foundational class is central to the **AgentForge** framework, enabling the creation, management, and operation of agents. It provides core functionalities essential for agents, serving as a robust template for both general and specialized implementations.

---

## Overview of the `Agent` Class

The `Agent` class is designed to:

- Serve as a base for all agents within the framework.
- Provide essential attributes and methods for agent operation.
- Facilitate seamless integration with various workflows and data structures.
- Simplify the creation of custom agents through method overriding.

---

## Class Definition

### Class Attributes

The `Agent` class utilizes several key attributes:

- **`agent_name`**: The name of the agent, typically set to the class name.
- **`logger`**: A logger instance initialized with the agentâ€™s name for logging messages.
- **`data`**: A dictionary to store data relevant for prompt rendering and inference.
- **`prompt`**: A list of prompts generated for use with the LLM.
- **`result`**: Stores the raw result returned by the LLM.
- **`output`**: Holds the final output after processing the LLM's response.
- **`agent_data`**: Configuration data specific to the agent, including settings and operational parameters.
- **`functions`**: Access to utility functions needed for the agent's operations.

### Initialization

```python
class Agent:
    def __init__(self):
        """
        Initializes an Agent instance by setting up its name, logger, data attributes,
        and loading agent-specific configurations.
        """
        self.agent_name: str = self.__class__.__name__
        self.logger: Logger = Logger(name=self.agent_name)
    
        self.data: Dict[str, Any] = {}
        self.prompt: Optional[List[str]] = None
        self.result: Optional[str] = None
        self.output: Optional[str] = None
    
        if not hasattr(self, 'agent_data'):
            self.agent_data: Optional[Dict[str, Any]] = None
    
        try:
            self.functions: Functions = Functions()
        except Exception as e:
            self.logger.log(f"Error during initialization of {self.agent_name}: {e}", 'error')
            raise
```

The `__init__` method prepares the agent for operation by initializing essential attributes and loading configuration data pertinent to its functionality.

---

## Core Method `run`

The `run` method is the central executor of the agent's workflow, coordinating the sequence of operations from data loading to output generation.

```python
def run(self, **kwargs: Any) -> Optional[str]:
    """
    Executes the agent's workflow: loading data, processing data, generating prompts,
    running the LLM, parsing results, saving results, and building the output.

    Parameters:
        **kwargs (Any): Keyword arguments that form part of the agent's data.

    Returns:
        Optional[str]: The output generated by the agent, or None if an error occurred.
    """
    try:
        self.logger.log(f"\n{self.agent_name} - Running...", 'info')
        self.load_data(**kwargs)
        self.process_data()
        self.generate_prompt()
        self.run_llm()
        self.parse_result()
        self.save_to_storage()
        self.build_output()
        self.data = {}
        self.logger.log(f"\n{self.agent_name} - Done!", 'info')
    except Exception as e:
        self.logger.log(f"Error running agent: {e}", 'error')
        return None

    return self.output
```

---

## Key Concepts

Understanding the following key concepts is essential for effectively utilizing the `Agent` class.

### The `self.data` Variable

#### Overview

The `self.data` variable is a central repository for all data pertinent to the agent's operation, especially for rendering prompt templates and executing LLM inference. It aggregates various pieces of information, ensuring they are accessible during execution.

#### Data Aggregation Process

1. **Loading Agent Configuration Data**:
   - When `load_agent_data` is called, it compiles essential data elements from the agent's configuration, including parameters and prompt templates.
   - Example:
     ```python
     self.data = {
         'params': self.agent_data.get('params').copy(),
         'prompts': self.agent_data['prompts'].copy()
     }
     ```
   - **Parameters (`params`)**: Settings that influence LLM behavior during inference.
   - **Prompts (`prompts`)**: Templates guiding the conversation or interaction flow.

2. **Integrating Additional Data**:
   - **Keyword Arguments (`**kwargs`)**: Inject runtime-specific data or context when invoking `run()`.
   - **Persona Data**: If available, persona attributes are added to `self.data`, allowing dynamic personalization.

#### Role in Prompt Rendering

During prompt rendering, `self.data` supplies the values for placeholders in prompt templates, enabling dynamic and contextually relevant interactions with the LLM.

> **Note**: Understanding `self.data` is crucial for tailoring agent behavior and enhancing interaction quality.

---

## Next Steps

- **Agent Prompt Rendering**: Dive deeper into how agent prompts are rendered within **AgentForge**. See the [Agent Prompts](AgentPrompts.md) guide.

- **Explore Custom Agents**: Learn how to create more complex agents by overriding methods in the `Agent` class. Refer to the [Custom Agents](CustomAgents.md) documentation.

- **Dive into Agent Methods**: For a detailed walkthrough of the main methods you can override, see the [Agent Methods](AgentMethods.md) page.

---

By understanding the `Agent` class and its core components, you can harness the full potential of the **AgentForge** framework to build powerful, customized agents tailored to your specific needs.
